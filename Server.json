{"files":[{"id":"cfc203ca-ce4e-4276-8c37-0daaeef5a39d","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Los_Angeles\",\n  \"dependencies\": {\n    \"libraries\": [\n      {\n        \"userSymbol\": \"ESGlobal\",\n        \"version\": \"0\",\n        \"libraryId\": \"1QCGr31jK3EUGzlUSnrjoxWa0dS-Dp-2JnJXkokoK6_IZkQxiXgW3szua\",\n        \"developmentMode\": true\n      }\n    ]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"9c6cc270-1d3a-45ee-a9a6-8d32d1c1bd3b","name":"Main","type":"server_js","source":"function doGet(e) {\n  const formName \u003d e.parameter.formName;\n\n  const teacherData \u003d  ESGlobal.accessTeacherDB().getData(formName);\n\n  return ContentService.createTextOutput(JSON.stringify(teacherData)).setMimeType(ContentService.MimeType.JSON);\n}\n\nfunction doPost(e) {\n  const data \u003d JSON.parse(e.postData.contents);\n  const action \u003d data.action;\n\n  let result;\n\n  switch (action) {\n    case \"updateSettings\":\n      ESGlobal.accessTeacherDB().updateSettings(data.formId, data.settings);\n      result \u003d { status: \"ok\", message: \"Updated teacher settings.\" };\n      break;\n    case \"accept\":\n      ESGlobal.handleAccept(data.studentBundle, data.teacherBundle);\n      result \u003d { status: \"ok\", message: \"Handled accept.\" };\n      break;\n\n    case \"reject\":\n      ESGlobal.handleReject(data.studentBundle, data.teacherBundle, data.reason);\n      result \u003d { status: \"ok\", message: \"Handled reject.\" };\n      break;\n\n    case \"absent\":\n      ESGlobal.handleAbsent(data.studentBundle);\n      result \u003d { status: \"ok\", message: \"Handled absent.\" };\n      break;\n\n    default:\n      result \u003d { status: \"error\", message: \"Unknown action\" };\n      break;\n  }\n\n  return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON);\n}"}]}
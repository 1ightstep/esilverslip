{"files":[{"id":"ec5c8591-cb0d-4f16-b5ab-07542ab90332","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Los_Angeles\",\n  \"dependencies\": {\n    \"libraries\": [\n      {\n        \"userSymbol\": \"ESGlobal\",\n        \"version\": \"0\",\n        \"libraryId\": \"1QCGr31jK3EUGzlUSnrjoxWa0dS-Dp-2JnJXkokoK6_IZkQxiXgW3szua\",\n        \"developmentMode\": true\n      }\n    ]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"cdff3fca-fbc3-4229-9754-38401a4d945f","name":"Updater","type":"server_js","source":"function updater() {\n  const teacherInfo \u003d ESGlobal.accessTeacherDB().getAllValues();\n  const targetFolder \u003d DriveApp.getFolderById(ESGlobal.getSheetsFolderId());\n  const template \u003d DriveApp.getFileById(ESGlobal.getUpdaterTemplateId());\n\n  const folderFiles \u003d targetFolder.getFilesByType(MimeType.GOOGLE_SHEETS);\n  while (folderFiles.hasNext()) {\n    const file \u003d folderFiles.next(); \n    file.setTrashed(true);\n  }\n  Logger.log(\"Deleted all spreadsheets in target folder.\")\n  Logger.log(\"Now cloning template/master spreadsheet.\")\n\n  teacherInfo.forEach((info) \u003d\u003e {\n    if (info[0]) {\n      const newName \u003d `Teacher Sheet - ${info[1]}`;\n      const newSS \u003d template.makeCopy(newName, targetFolder);\n      const newSSId \u003d newSS.getId(); \n\n      ESGlobal.accessTeacherDB().setData(info[0], {\n        newSheetId: newSSId, \n        formName: info[1], \n        room: info[2], \n        email: info[3], \n        automaticMode: info[4], \n        substituteMode: info[5], \n        maxAdditions: info[6]\n      });\n      newSS.addEditor(info[3]);\n      ESGlobal.sendUpdateEmail(info[3], info[1], newSS.getUrl());\n\n      Logger.log(`${newName} has been updated.`)\n    }\n  });\n}\n"}]}
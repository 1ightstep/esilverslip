{"files":[{"id":"2c397c00-a56d-4b53-9972-903629e4b03c","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Los_Angeles\",\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"dependencies\": {\n    \"libraries\": [\n      {\n        \"userSymbol\": \"ESGlobal\",\n        \"version\": \"0\",\n        \"libraryId\": \"1QCGr31jK3EUGzlUSnrjoxWa0dS-Dp-2JnJXkokoK6_IZkQxiXgW3szua\",\n        \"developmentMode\": true\n      }\n    ]\n  }\n}"},{"id":"b5b1a0fb-4766-4311-a29f-1b950af44628","name":"Code","type":"server_js","source":"function initializer() {\n  const initializerSS \u003d SpreadsheetApp.openById(\n    \"1kVroS3iBc03IdKMpu5CqlfVAjosgwN7CSfQwM2Hr8N4\"\n  ); //ESGlobal not necessary since it\u0027s one time use\n  const teacherInfo \u003d initializerSS\n    .getSheetByName(\"initializer\")\n    .getRange(2, 1, initializerSS.getLastRow(), initializerSS.getLastColumn())\n    .getValues();\n  const targetFolder \u003d DriveApp.getFolderById(ESGlobal.getSheetsFolderId());\n  const template \u003d DriveApp.getFileById(ESGlobal.getUpdaterTemplateId());\n\n  const folderFiles \u003d targetFolder.getFilesByType(MimeType.GOOGLE_SHEETS);\n  while (folderFiles.hasNext()) {\n    const file \u003d folderFiles.next();\n    file.setTrashed(true);\n  }\n  Logger.log(\"Deleted all spreadsheets in target folder.\");\n  Logger.log(\"Now cloning template/master spreadsheet.\");\n\n  const rootDrive \u003d DriveApp.getFolderById(\"0ABEG3VNxy80-Uk9PVA\"); //ESGlobal not necessary since it\u0027s one time use\n  teacherInfo.forEach((info) \u003d\u003e {\n    if (info[0] \u0026\u0026 info[1]) {\n      const newName \u003d `Teacher Sheet - ${info[0]}`;\n      const newSS \u003d template.makeCopy(newName, targetFolder);\n\n      newSS.addEditor(info[1]);\n      rootDrive.addEditor(info[1]);\n      ESGlobal.sendUpdateEmail(info[1], info[0], newSS.getUrl());\n\n\n      Logger.log(`${newName} has been added.`);\n    }\n  });\n}\n"}]}